{
  "curs": {
    "nom": "SQL",
    "descripcio": "Aprèn a dominar les funcions analítiques de SQL per a l'anàlisi de dades avançada.",
    "color_fons": "#F4F8F4"
  },
  "capitol": {
    "titol": "Funcions analítiques (Window Functions)",
    "numero": 9,
    "dificultat": "Avançat",
    "preu": 0.0
  },
  "exercicis": [
    {
      "numero": 1,
      "titol": "Introducció a OVER()",
      "tipus": "codi",
      "descripcio": "Les funcions analítiques de SQL permeten realitzar càlculs més complexos sobre les dades. La clàusula OVER() és fonamental per a les funcions analítiques. Explica què fa la clàusula OVER() i com s'utilitza.",
      "enunciat": "Crea una consulta SQL que utilitzi la clàusula OVER() per calcular el nombre de fileres per cada grup de la taula 'empleats' segons el departament.",
      "solucio": "Nombre de fileres per departament",
      "solucio_codi_1": "SELECT departament, COUNT(*) OVER (PARTITION BY departament) AS nombre_filera FROM empleats",
      "solucio_codi_2": null,
      "codi_a_completar": null,
      "temps_estimat_minuts": 10,
      "respostes_test": [],
      "pista_1": "Utilitza la clàusula PARTITION BY per dividir les dades en grups.",
      "pista_2": "La clàusula OVER() permet especificar la finestra sobre la qual es realitza el càlcul.",
      "imatge_1": null,
      "descripcio_imatge_1": null,
      "imatge_2": null,
      "descripcio_imatge_2": null
    },
    {
      "numero": 2,
      "titol": "Funcions de rang",
      "tipus": "test",
      "descripcio": "Les funcions RANK, DENSE_RANK i ROW_NUMBER permeten assignar un rang o un número a les files d'una taula. Explica les diferències entre aquestes funcions.",
      "enunciat": "Quina funció analítica permet assignar un rang a les files sense deixar forats si hi ha empats?",
      "solucio": "DENSE_RANK()",
      "solucio_codi_1": null,
      "solucio_codi_2": null,
      "codi_a_completar": null,
      "temps_estimat_minuts": 5,
      "respostes_test": [
        "RANK()",
        "DENSE_RANK()",
        "ROW_NUMBER()",
        "NTILE()"
      ],
      "pista_1": "RANK() deixa forats si hi ha empats.",
      "pista_2": "DENSE_RANK() no deixa forats.",
      "imatge_1": null,
      "descripcio_imatge_1": null,
      "imatge_2": null,
      "descripcio_imatge_2": null
    },
    {
      "numero": 3,
      "titol": "SUM() OVER() per anàlisi mòbil",
      "tipus": "codi",
      "descripcio": "La funció SUM() OVER() permet realitzar sumes mòbils sobre les dades. Explica com utilitzar aquesta funció per calcular la suma acumulada.",
      "enunciat": "Crea una consulta SQL que calculi la suma acumulada dels ingressos mensuals d'una empresa.",
      "solucio": "Suma acumulada dels ingressos",
      "solucio_codi_1": "SELECT data, ingressos, SUM(ingressos) OVER (ORDER BY data) AS suma_acumulada FROM ingressos_mensuals",
      "solucio_codi_2": null,
      "codi_a_completar": null,
      "temps_estimat_minuts": 10,
      "respostes_test": [],
      "pista_1": "Utilitza la clàusula ORDER BY per especificar l'ordre de les dates.",
      "pista_2": "La clàusula OVER() permet especificar la finestra sobre la qual es realitza el càlcul.",
      "imatge_1": null,
      "descripcio_imatge_1": null,
      "imatge_2": null,
      "descripcio_imatge_2": null
    },
    {
      "numero": 4,
      "titol": "AVG() OVER() per anàlisi mòbil",
      "tipus": "codi",
      "descripcio": "La funció AVG() OVER() permet realitzar mitjanes mòbils sobre les dades. Explica com utilitzar aquesta funció per calcular la mitjana acumulada.",
      "enunciat": "Crea una consulta SQL que calculi la mitjana acumulada dels preus d'un producte.",
      "solucio": "Mitjana acumulada dels preus",
      "solucio_codi_1": "SELECT data, preu, AVG(preu) OVER (ORDER BY data) AS mitjana_acumulada FROM preus_producte",
      "solucio_codi_2": null,
      "codi_a_completar": null,
      "temps_estimat_minuts": 10,
      "respostes_test": [],
      "pista_1": "Utilitza la clàusula ORDER BY per especificar l'ordre de les dates.",
      "pista_2": "La clàusula OVER() permet especificar la finestra sobre la qual es realitza el càlcul.",
      "imatge_1": null,
      "descripcio_imatge_1": null,
      "imatge_2": null,
      "descripcio_imatge_2": null
    },
    {
      "numero": 5,
      "titol": "PARTITION BY i ORDER BY dins funcions analítiques",
      "tipus": "codi",
      "descripcio": "Les clàusules PARTITION BY i ORDER BY són fonamentals per a les funcions analítiques. Explica com utilitzar aquestes clàusules per dividir les dades en grups i ordenar-les.",
      "enunciat": "Crea una consulta SQL que calcular la suma dels ingressos per departament i any, ordenats per any.",
      "solucio": "Suma dels ingressos per departament i any",
      "solucio_codi_1": "SELECT departament, ANY, SUM(ingressos) OVER (PARTITION BY departament ORDER BY ANY) AS suma_ingressos FROM ingressos_anuals",
      "solucio_codi_2": null,
      "codi_a_completar": null,
      "temps_estimat_minuts": 10,
      "respostes_test": [],
      "pista_1": "Utilitza la clàusula PARTITION BY per dividir les dades en grups.",
      "pista_2": "La clàusula ORDER BY permet ordenar les dades dintre de cada grup.",
      "imatge_1": null,
      "descripcio_imatge_1": null,
      "imatge_2": null,
      "descripcio_imatge_2": null
    }
  ]
}